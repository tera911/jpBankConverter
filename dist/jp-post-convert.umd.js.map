{"version":3,"file":"jp-post-convert.umd.js","sources":["../src/jp-post-branch.ts","../src/jp-post-convert.ts"],"sourcesContent":["export class JpPostBranch {\n  private static _kansuji = ['〇', '一', '二', '三', '四', '五', '六', '七', '八', '九']\n  private static _kansujiYomi = [\n    'ゼロ',\n    'イチ',\n    'ニ',\n    'サン',\n    'ヨン',\n    'ゴ',\n    'ロク',\n    'ナナ',\n    'ハチ',\n    'キユウ'\n  ]\n  private _branchName: string\n  private _branchKana: string\n  private _branchCode: string\n\n  constructor(branchCode: string) {\n    if (branchCode.length !== 3) {\n      throw Error('支店番号が不正です')\n    }\n    this._branchKana = branchCode\n      .split('')\n      .map(e => {\n        return JpPostBranch._kansujiYomi[parseInt(e, 0)]\n      })\n      .join('')\n    this._branchName = branchCode\n      .split('')\n      .map(e => {\n        return JpPostBranch._kansuji[parseInt(e, 0)]\n      })\n      .join('')\n    this._branchCode = branchCode\n  }\n\n  get code() {\n    return this._branchCode\n  }\n\n  get name() {\n    return this._branchName\n  }\n\n  get kana() {\n    return this._branchKana\n  }\n}\n","import { JpPostBranch } from './jp-post-branch'\n\nexport default class JpPostConvert {\n  private _symbol1: string\n  private _symbol2: string\n  private _jNumber: string\n\n  constructor(symbol1: string, symbol2: string, jNumber: string) {\n    this._symbol1 = symbol1\n    this._symbol2 = symbol2.length === 0 ? '0' : symbol2\n    this._jNumber = jNumber\n\n    if (!this.validate()) {\n      throw new Error('口座情報が不正です。')\n    }\n  }\n\n  toJpBranch(): JpPostBranch {\n    let branchCode = '0'\n    if (this.isNormalType()) {\n      branchCode = this._symbol1.substr(1, 2) + '8'\n    } else {\n      branchCode = this._symbol1.substr(1, 2) + '9'\n    }\n    return new JpPostBranch(branchCode)\n  }\n\n  toBankNumber(): string {\n    if (this.isNormalType()) {\n      return ('00000000' + this._jNumber)\n        .substr(('00000000' + this._jNumber).length - 8)\n        .substr(0, 7)\n    } else {\n      return ('0000000' + this._jNumber).substr(\n        ('0000000' + this._jNumber).length - 7\n      )\n    }\n  }\n\n  public isNormalType(): boolean {\n    return !(this._symbol2.substr(0, 1) === '1')\n  }\n\n  private validate(): boolean {\n    let isNormal = this.isNormalType()\n    let c = this._symbol1.substr(1, 2)\n\n    let s1 = this._symbol1\n    let s2 = this._symbol2\n    let s3 = this._jNumber\n\n    /** どれか一つでもNGならエラー */\n    return !(\n      !s1.match(/^\\d{5}$/) ||\n      !s2.match(/^\\d?$/) ||\n      (isNormal && !s3.match(/^\\d{1,8}$/)) ||\n      (!isNormal && !s3.match(/^\\d{1,6}$/)) ||\n      !s1.match(/^[01]/) ||\n      !s1.match(/0$/) ||\n      (isNormal && !s3.match(/1$/)) ||\n      !this.checkDigit()\n    )\n  }\n\n  private checkDigit(): boolean {\n    let s1 = this._symbol1\n    let s3 = this._jNumber\n    let digit = parseInt(s1.substr(3, 1), 0)\n\n    let numbers = ('00000000' + this._jNumber).substr(\n      ('00000000' + this._jNumber).length - 8\n    )\n\n    let list: string[] = [\n      numbers.substr(numbers.length - 1, 1),\n      numbers.substr(numbers.length - 2, 1),\n      numbers.substr(numbers.length - 3, 1),\n      numbers.substr(numbers.length - 4, 1),\n      numbers.substr(numbers.length - 5, 1),\n      numbers.substr(numbers.length - 6, 1),\n      numbers.substr(numbers.length - 7, 1),\n      numbers.substr(numbers.length - 8, 1),\n\n      s1.substr(4, 1),\n      '0',\n      s1.substr(2, 1),\n      s1.substr(1, 1),\n      s1.substr(0, 1)\n    ]\n\n    let total = list\n      .map((e, i) => {\n        let num = parseInt(e, 0)\n        let c: number = 0\n        if (i % 3 === 0) {\n          c = num\n        } else if (i % 3 === 1) {\n          if (num > 4) {\n            c = num * 2 - 9\n          } else {\n            c = num * 2\n          }\n        } else if (i % 3 === 2) {\n          c = num * 3\n        }\n        return c\n      })\n      .reduce((a, b) => {\n        return a + b\n      }, 0)\n    return total % 10 === digit\n  }\n}\n"],"names":[],"mappings":"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"}